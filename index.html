<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reporte de Horas Mensuales</title>
    
    <!-- Incluye los SDKs de Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
    
    <style>
        /* Estilos Mobile-First y Responsive */
        body { 
            font-family: Arial, sans-serif; 
            display: flex; 
            justify-content: center; 
            align-items: flex-start;
            min-height: 100vh; 
            background-color: #f4f4f4; 
            margin: 0; 
            padding: 20px 10px;
        }
        .container { 
            background: white; 
            padding: 20px; 
            border-radius: 8px; 
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); 
            width: 100%;
            max-width: 600px;
            text-align: center; 
            box-sizing: border-box; 
        }
        
        /* Estilos de inputs, select y botones */
        input, select, textarea, button { 
            width: 100%; 
            padding: 10px; 
            margin: 8px 0; 
            border: 1px solid #ccc; 
            border-radius: 4px; 
            box-sizing: border-box; 
            font-size: 1em;
        }
        button { 
            color: white; 
            border: none; 
            cursor: pointer; 
            background-color: #5cb85c; 
            font-weight: bold;
        }
        button:hover { 
            opacity: 0.9; 
        }
        .hidden { 
            display: none; 
        }
        .card { 
            border: 1px solid #ddd; 
            padding: 15px; 
            border-radius: 6px; 
            text-align: left; 
            margin-bottom: 20px;
        }
        .info-box {
            background-color: #e3f2fd; 
            color: #1a237e; 
            padding: 10px;
            border-radius: 4px;
            font-weight: bold;
            margin-bottom: 15px;
        }
        .radio-group label {
            display: block;
            margin: 10px 0;
            cursor: pointer;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            background-color: #f9f9f9;
        }
        .radio-group input[type="radio"]:checked + label {
            background-color: #2196f3;
            color: white;
            border-color: #2196f3;
        }

        /* Estilos para el √°rea de administraci√≥n */
        #admin-view {
            margin-top: 30px;
            border-top: 2px dashed #ccc;
            padding-top: 20px;
        }
        #export-button {
            background-color: #007bff;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>

<div class="container">
    <!-- VISTA DE AUTENTICACI√ìN (LOGIN/REGISTRO) -->
    <div id="auth-view">
        <h2>Reporte de Horas</h2>
        <p id="message" style="color: red;"></p>

        <!-- Formularios de Auth (no cambia) -->
        <div id="register-form">
            <h3>Registrarse</h3>
            <input type="email" id="reg-email" placeholder="Correo Electr√≥nico" required>
            <input type="password" id="reg-password" placeholder="Contrase√±a (m√≠n. 6 caracteres)" required>
            <button onclick="registerUser()">Registrar</button>
            <p>¬øYa tienes cuenta? <a href="#" onclick="showLogin()">Inicia Sesi√≥n</a></p>
        </div>
        <div id="login-form" class="hidden">
            <h3>Iniciar Sesi√≥n</h3>
            <input type="email" id="log-email" placeholder="Correo Electr√≥nico" required>
            <input type="password" id="log-password" placeholder="Contrase√±a" required>
            <button onclick="loginUser()">Entrar</button>
            <p>¬øNo tienes cuenta? <a href="#" onclick="showRegister()">Reg√≠strate</a></p>
        </div>
    </div>

    <!-- VISTA PRIVADA (DASHBOARD DE EMPLEADO) -->
    <div id="private-view" class="hidden">
        <h2>Panel de Reporte Mensual</h2>
        <p>Bienvenido/a: <strong id="employee-name">...</strong></p>
        
        <!-- √Årea de Referencia de Horario -->
        <div class="info-box">
            Tu horario habitual: <span id="horario-habitual-display">Cargando...</span>
        </div>

        <!-- CARD: Formulario de Reporte Diario -->
        <div class="card">
            <h3>üìÖ Reporte del D√≠a</h3>
            
            <input type="date" id="report-date" required>
            
            <div class="radio-group">
                <p style="font-weight: bold; margin-top: 15px;">¬øC√≥mo fue tu jornada?</p>
                
                <input type="radio" id="type-habitual" name="report_type" value="HABITUAL" checked>
                <label for="type-habitual">‚úÖ Hice mi horario habitual</label>

                <input type="radio" id="type-extra" name="report_type" value="EXTRA">
                <label for="type-extra">‚è±Ô∏è Reportar horas/d√≠as extra</label>
                
                <input type="radio" id="type-falta" name="report_type" value="FALTA">
                <label for="type-falta">‚ùå Falt√© / Tuve Ausencia</label>
            </div>
            
            <!-- Campo Oculto para Horario Reportado/Extra -->
            <div id="extra-hours-section" class="hidden" style="margin-top: 10px;">
                <p style="font-weight: bold; margin: 10px 0 5px;">Detalle de Horas Extra/Diferentes:</p>
                <!-- Usamos un campo de texto simple para que el empleado escriba el horario -->
                <input type="text" id="horario-reportado" placeholder="Ej: 08:00 a 19:00 (o 3 horas extra)">
            </div>
            
            <!-- Campo Comentarios -->
            <textarea id="comentarios" placeholder="Comentarios adicionales (permiso, motivo de falta, etc.)"></textarea>

            <button onclick="saveTimeSheet()" style="background-color: #28a745;">üíæ Guardar Reporte Diario</button>
        </div>

        <!-- √Årea de Administraci√≥n (Visible solo para el admin: tu cuenta) -->
        <div id="admin-view" class="hidden">
            <h3>üõ†Ô∏è √Årea de Administraci√≥n</h3>
            <p>Acceso total a todos los reportes de los empleados.</p>
            <button onclick="exportToCsv()" id="export-button">‚¨áÔ∏è Exportar Todos los Datos a CSV (Excel)</button>
        </div>

        <button onclick="logoutUser()" style="background-color: #d9534f; margin-top: 10px;">Cerrar Sesi√≥n</button>
    </div>
</div>

<!-- Enlace al archivo de l√≥gica -->
<script src="app.js"></script>

</body>
</html>
