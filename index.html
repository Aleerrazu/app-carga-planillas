<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Control Horario ‚Äì Admin / Empleado</title>
  <style>
    :root{
      --bg:#0f172a; --card:#111827; --muted:#1f2937; --accent:#2563eb;
      --good:#16a34a; --bad:#dc2626; --warn:#d97706; --text:#e5e7eb; --textmuted:#94a3b8; --chip:#334155;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;background:linear-gradient(180deg,#0b1223,#0f172a);color:var(--text);font-family:ui-sans-serif,system-ui,Segoe UI,Roboto,Ubuntu,Cantarell,"Noto Sans",sans-serif;}
    .wrap{max-width:1180px;margin:24px auto;padding:0 16px}
    .brand{display:flex;align-items:center;gap:10px;margin-bottom:16px}
    .brand .dot{width:12px;height:12px;border-radius:50%;background:var(--accent);box-shadow:0 0 18px rgba(37,99,235,.8)}
    .title{font-size:22px;font-weight:700;letter-spacing:.3px}
    .card{background:var(--card);border:1px solid #1f2937;border-radius:14px;box-shadow:0 10px 35px rgba(0,0,0,.25)}
    .grid{display:grid;gap:16px}
    .grid-2{grid-template-columns:1fr 1fr}
    .grid-3{grid-template-columns:1fr 1fr 1fr}
    .grid-4{grid-template-columns:1fr 1fr 1fr 1fr}
    .pad{padding:16px}
    .muted{color:var(--textmuted)}
    .row{display:flex;align-items:center;gap:10px;flex-wrap:wrap}
    .sp{justify-content:space-between}
    .btn{background:var(--accent);color:white;border:none;border-radius:10px;padding:10px 14px;font-weight:600;cursor:pointer;transition:transform .05s ease,opacity .15s ease;}
    .btn:active{transform:translateY(1px)}
    .btn.gray{background:#374151}
    .btn.good{background:var(--good)}
    .btn.bad{background:var(--bad)}
    .btn.warn{background:var(--warn)}
    .btn.small{padding:6px 10px;font-weight:500;border-radius:8px}
    .segmented{background:#0b1223;border:1px solid #1f2937;border-radius:12px;padding:4px;display:inline-flex;gap:4px}
    .segmented button{background:transparent;color:var(--textmuted);padding:8px 12px;border-radius:8px;border:none;cursor:pointer}
    .segmented button.active{background:var(--accent);color:white}
    input,select,textarea{background:#0b1223;border:1px solid #1f2937;color:var(--text);padding:10px 12px;border-radius:10px;width:100%}
    label{font-size:12px;color:var(--textmuted);display:block;margin:8px 2px}
    table{width:100%;border-collapse:collapse}
    th,td{padding:10px;border-bottom:1px solid #1f2937}
    th{color:#93c5fd;text-align:left;background:#0b1223}
    .chip{background:var(--chip);padding:4px 8px;border-radius:999px;font-size:12px}
    .hidden{display:none !important}
    .msg{margin:10px 0;font-size:14px}
    .kpi{display:flex;gap:12px;flex-wrap:wrap}
    .kpi .item{background:#0b1223;border:1px solid #1f2937;border-radius:12px;padding:10px 12px}
    .danger{color:#fecaca}
    .grid-7{display:grid;grid-template-columns:repeat(7,1fr);gap:12px}
    .tiny{font-size:12px}
    .list{display:flex;flex-direction:column;gap:8px;max-height:420px;overflow:auto}
    .list .item{background:#0b1223;border:1px solid #1f2937;border-radius:12px;padding:10px;display:flex;align-items:center;justify-content:space-between}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="brand">
      <div class="dot"></div>
      <div class="title">Control Horario ¬∑ Panel</div>
      <div class="chip" id="env-chip">Desconectado</div>
      <div class="chip" id="role-chip">‚Äì</div>
      <div style="flex:1"></div>
      <div class="muted" id="user-email">‚Äî</div>
      <button class="btn small gray" id="logout-btn">Salir</button>
    </div>

    <!-- AUTH -->
    <div id="auth-card" class="card pad">
      <div class="row sp">
        <div><b>Ingresar</b></div>
        <div class="segmented">
          <button id="tab-login" class="active">Login</button>
          <button id="tab-register">Registro</button>
        </div>
      </div>
      <div class="grid grid-2" style="margin-top:10px">
        <div><label>Email</label><input id="email" type="email" placeholder="tu@email.com"/></div>
        <div><label>Contrase√±a</label><input id="password" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"/></div>
      </div>
      <div class="row" style="margin-top:10px">
        <button class="btn" id="login-btn">Entrar</button>
        <button class="btn gray" id="register-btn">Crear cuenta</button>
        <button class="btn warn" id="reset-btn">Blanquear contrase√±a</button>
        <div class="msg" id="auth-msg"></div>
      </div>
    </div>

    <!-- APP -->
    <div id="app-card" class="card pad hidden">
      <!-- SWITCH VIEW -->
      <div class="row sp" style="margin-bottom:10px">
        <div class="row">
          <div class="chip">Mes: <span id="month-chip">‚Äî</span></div>
          <div class="chip">√öltima actualizaci√≥n: <span id="last-update-chip">‚Äî</span></div>
          <div class="chip">Bloqueo: <span id="lock-chip">‚Äî</span></div>
        </div>
        <div class="segmented">
          <button id="seg-employee" class="active">Empleado</button>
          <button id="seg-admin">Admin</button>
        </div>
      </div>

      <!-- EMPLOYEE VIEW -->
      <div id="employee-view">
        <div class="grid grid-3">
          <div class="kpi item">
            <div class="item"><div class="muted">Empleado</div><div id="emp-name" style="font-weight:700">‚Äî</div></div>
          </div><div></div><div></div>
        </div>
        <div class="card pad" style="margin-top:12px">
          <b>Vista empleado (luego la completamos)</b>
          <div class="muted tiny">Ahora estamos enfocando la parte Admin.</div>
        </div>
      </div>

      <!-- ADMIN VIEW -->
      <div id="admin-view" class="hidden">
        <div class="row" style="justify-content:center;margin-bottom:12px">
          <div class="segmented">
            <button id="tab-admin-employees" class="active">üë• Empleados</button>
            <button id="tab-admin-schedules">üóìÔ∏è Horarios</button>
            <button id="tab-admin-month">üìä Estado mensual</button>
          </div>
        </div>

        <!-- ADMIN EMPLOYEES -->
        <div id="admin-employees">
          <div class="grid grid-2">
            <div class="card pad">
              <b>Crear / Editar Empleado</b>
              <div class="grid grid-2" style="margin-top:10px">
                <div><label>Nombre completo</label><input id="adm-name" placeholder="Nombre y Apellido"></div>
                <div><label>Usuario (opcional)</label><input id="adm-username" placeholder="@usuario"></div>
                <div><label>Email (Auth)</label><input id="adm-email" placeholder="empleado@ejemplo.com"></div>
                <div><label>UID empleado</label><input id="adm-uid" placeholder="UID exacto"></div>
              </div>
              <div class="row" style="margin-top:10px">
                <button class="btn" id="adm-save-employee">Crear/Actualizar</button>
                <button class="btn warn" id="adm-reset">Enviar blanqueo contrase√±a</button>
                <div class="msg" id="adm-msg"></div>
              </div>
              <div class="tiny muted" style="margin-top:8px">
                Nota: desde el cliente no se puede cambiar directamente la contrase√±a ni el email de otro usuario; se env√≠a un mail de blanqueo y el usuario confirma.
              </div>
            </div>

            <div class="card pad">
              <b>Lista de empleados</b>
              <div class="list" id="adm-users-list"></div>
              <div class="msg" id="adm-users-msg"></div>
            </div>
          </div>
        </div>

        <!-- ADMIN SCHEDULES -->
        <div id="admin-schedules" class="hidden">
          <div class="grid grid-2">
            <div class="card pad">
              <div class="row sp">
                <b>Seleccionar empleado</b>
                <button class="btn gray small" id="sched-refresh">Actualizar lista</button>
              </div>
              <div class="list" id="sched-users"></div>
              <div class="msg" id="sched-users-msg"></div>
            </div>

            <div class="card pad">
              <b>Horario habitual de <span id="sched-emp-name">‚Äî</span></b>
              <div class="grid-7" style="margin-top:8px">
                <div class="card pad"><b class="tiny">Lunes</b><label>Inicio</label><input id="mon-start"><label>Fin</label><input id="mon-end"><div class="row"><label><input type="checkbox" id="mon-off"> No trabaja</label><label><input type="checkbox" id="mon-var"> Variable</label></div></div>
                <div class="card pad"><b class="tiny">Martes</b><label>Inicio</label><input id="tue-start"><label>Fin</label><input id="tue-end"><div class="row"><label><input type="checkbox" id="tue-off"> No trabaja</label><label><input type="checkbox" id="tue-var"> Variable</label></div></div>
                <div class="card pad"><b class="tiny">Mi√©rcoles</b><label>Inicio</label><input id="wed-start"><label>Fin</label><input id="wed-end"><div class="row"><label><input type="checkbox" id="wed-off"> No trabaja</label><label><input type="checkbox" id="wed-var"> Variable</label></div></div>
                <div class="card pad"><b class="tiny">Jueves</b><label>Inicio</label><input id="thu-start"><label>Fin</label><input id="thu-end"><div class="row"><label><input type="checkbox" id="thu-off"> No trabaja</label><label><input type="checkbox" id="thu-var"> Variable</label></div></div>
                <div class="card pad"><b class="tiny">Viernes</b><label>Inicio</label><input id="fri-start"><label>Fin</label><input id="fri-end"><div class="row"><label><input type="checkbox" id="fri-off"> No trabaja</label><label><input type="checkbox" id="fri-var"> Variable</label></div></div>
                <div class="card pad"><b class="tiny">S√°bado</b><label>Inicio</label><input id="sat-start"><label>Fin</label><input id="sat-end"><div class="row"><label><input type="checkbox" id="sat-off"> No trabaja</label><label><input type="checkbox" id="sat-var"> Variable</label></div></div>
                <div class="card pad"><b class="tiny">Domingo</b><label>Inicio</label><input id="sun-start"><label>Fin</label><input id="sun-end"><div class="row"><label><input type="checkbox" id="sun-off"> No trabaja</label><label><input type="checkbox" id="sun-var"> Variable</label></div></div>
              </div>
              <div class="grid grid-3" style="margin-top:10px">
                <div><label>Resumen (texto opcional)</label><input id="adm-sched" placeholder="L-V 9-18"></div>
                <div></div><div></div>
              </div>
              <div class="row" style="margin-top:10px">
                <button class="btn" id="save-schedule">Guardar horario</button>
                <div class="msg" id="sched-msg"></div>
              </div>
            </div>
          </div>
        </div>

        <!-- ADMIN MONTH STATUS -->
        <div id="admin-month" class="hidden">
          <div class="card pad">
            <div class="row sp">
              <b>Estado de planillas por mes</b>
              <div class="row">
                <label>Mes</label><input type="month" id="adm-month">
                <button class="btn gray" id="adm-refresh">Actualizar</button>
                <button class="btn gray" id="export-csv">Exportar CSV</button>
              </div>
            </div>
            <div class="pad" style="padding-top:0">
              <table>
                <thead><tr><th>Nombre</th><th>Email</th><th>UID</th><th>Estado mes</th><th>Acciones</th></tr></thead>
                <tbody id="adm-list"></tbody>
              </table>
              <div class="msg" id="adm-list-msg"></div>
            </div>
          </div>
          <div class="card pad" style="margin-top:12px">
            <b>Bloqueo manual</b>
            <div class="grid grid-3" style="margin-top:8px">
              <div><label>UID empleado</label><input id="adm-lock-uid" placeholder="uid..."></div>
              <div><label>Mes (YYYY-MM)</label><input id="adm-lock-month" placeholder="2025-10"></div>
              <div class="row" style="align-items:end">
                <button class="btn bad" id="adm-unlock">Permitir cambios</button>
                <button class="btn good" id="adm-lock">Bloquear</button>
              </div>
            </div>
            <div class="msg" id="lock-msg"></div>
          </div>
        </div>

      </div>
    </div>
  </div>

  <!-- Firebase compat SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
  <script src="app.js"></script>
</body>
</html>
